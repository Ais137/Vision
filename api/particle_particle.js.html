<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>particle/particle.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h3>Tutorials</h3><ul><li><a href="tutorial-01-快速入门.html">01-快速入门</a></li><li><a href="tutorial-02-模板生成器.html">02-模板生成器</a></li></ul><h3>Modules</h3><ul><li><a href="module-algo_Boids.html">algo/Boids</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-algo_Boids.html#~boids_middlewares">boids_middlewares</a></li></ul></li><li><a href="module-algo_LSystem.html">algo/LSystem</a></li><li><a href="module-algo_Mandelbrot_Set.html">algo/Mandelbrot_Set</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-algo_Mandelbrot_Set.html#~Mandelbrot_Set">Mandelbrot_Set</a></li><li data-type='method' style='display: none;'><a href="module-algo_Mandelbrot_Set.html#~Julia_Set">Julia_Set</a></li></ul></li><li><a href="module-algo_NNS.html">algo/NNS</a></li><li><a href="module-algo_OSS.html">algo/OSS</a></li><li><a href="module-context_canvas.html">context/canvas</a></li><li><a href="module-particle_area.html">particle/area</a></li><li><a href="module-particle_border.html">particle/border</a></li><li><a href="module-particle_coor.html">particle/coor</a></li><li><a href="module-particle_field.html">particle/field</a></li><li><a href="module-particle_particle.html">particle/particle</a></li><li><a href="module-particle_particle_system.html">particle/particle_system</a></li><li><a href="module-particle_tracker.html">particle/tracker</a></li><li><a href="module-utils_iterator.html">utils/iterator</a></li><li><a href="module-utils_random.html">utils/random</a></li><li><a href="module-utils_tools.html">utils/tools</a></li><li><a href="module-vector_vector.html">vector/vector</a></li><li><a href="module-views_capturer.html">views/capturer</a></li><li><a href="module-views_color.html">views/color</a></li><li><a href="module-views_randerer.html">views/randerer</a></li><li><a href="module-views_views.html">views/views</a></li></ul><h3>Classes</h3><ul><li><a href="module-algo_Boids-Boid.html">Boid</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-algo_Boids-Boid.html#rules_action">rules_action</a></li><li data-type='method' style='display: none;'><a href="module-algo_Boids-Boid.html#action">action</a></li></ul></li><li><a href="module-algo_LSystem-LSystem.html">LSystem</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-algo_LSystem-LSystem.html#next">next</a></li><li data-type='method' style='display: none;'><a href="module-algo_LSystem-LSystem.html#gen">gen</a></li><li data-type='method' style='display: none;'><a href="module-algo_LSystem-LSystem.html#iter">iter</a></li><li data-type='method' style='display: none;'><a href="module-algo_LSystem-LSystem.html#act">act</a></li><li data-type='method' style='display: none;'><a href="module-algo_LSystem-LSystem.html#actIter">actIter</a></li></ul></li><li><a href="module-algo_Mandelbrot_Set-Complex.html">Complex</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-algo_Mandelbrot_Set-Complex.html#add">add</a></li><li data-type='method' style='display: none;'><a href="module-algo_Mandelbrot_Set-Complex.html#mult">mult</a></li><li data-type='method' style='display: none;'><a href="module-algo_Mandelbrot_Set-Complex.html#norm">norm</a></li></ul></li><li><a href="module-algo_NNS-NearestNeighborSearch.html">NearestNeighborSearch</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-algo_NNS-NearestNeighborSearch.html#build">build</a></li><li data-type='method' style='display: none;'><a href="module-algo_NNS-NearestNeighborSearch.html#near">near</a></li><li data-type='method' style='display: none;'><a href="module-algo_NNS-NearestNeighborSearch.html#k_near">k_near</a></li><li data-type='method' style='display: none;'><a href="module-algo_NNS-NearestNeighborSearch.html#nps">nps</a></li><li data-type='method' style='display: none;'><a href="module-algo_NNS-NearestNeighborSearch.html#.toGraph">toGraph</a></li></ul></li><li><a href="module-algo_NNS-LinearNNS.html">LinearNNS</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-algo_NNS-LinearNNS.html#near">near</a></li><li data-type='method' style='display: none;'><a href="module-algo_NNS-LinearNNS.html#k_near">k_near</a></li></ul></li><li><a href="module-algo_NNS-GridNNS.html">GridNNS</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-algo_NNS-GridNNS.html#.GridContainer">GridContainer</a></li><li data-type='method' style='display: none;'><a href="module-algo_NNS-GridNNS.html#build">build</a></li><li data-type='method' style='display: none;'><a href="module-algo_NNS-GridNNS.html#near">near</a></li><li data-type='method' style='display: none;'><a href="module-algo_NNS-GridNNS.html#k_near">k_near</a></li></ul></li><li><a href="module-algo_NNS-GridContainer.html">GridContainer</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-algo_NNS-GridContainer.html#toGrid">toGrid</a></li><li data-type='method' style='display: none;'><a href="module-algo_NNS-GridContainer.html#index">index</a></li><li data-type='method' style='display: none;'><a href="module-algo_NNS-GridContainer.html#gns">gns</a></li><li data-type='method' style='display: none;'><a href="module-algo_NNS-GridContainer.html#set">set</a></li><li data-type='method' style='display: none;'><a href="module-algo_NNS-GridContainer.html#get">get</a></li></ul></li><li><a href="module-algo_OSS-Solver.html">Solver</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-algo_OSS-Solver.html#action">action</a></li><li data-type='method' style='display: none;'><a href="module-algo_OSS-Solver.html#isEnd">isEnd</a></li></ul></li><li><a href="module-algo_OSS-OptimumSolutionSolvers.html">OptimumSolutionSolvers</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-algo_OSS-OptimumSolutionSolvers.html#init">init</a></li><li data-type='method' style='display: none;'><a href="module-algo_OSS-OptimumSolutionSolvers.html#next">next</a></li><li data-type='method' style='display: none;'><a href="module-algo_OSS-OptimumSolutionSolvers.html#isEnd">isEnd</a></li></ul></li><li><a href="module-context_canvas-Canvas.html">Canvas</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-context_canvas-Canvas.html#resize">resize</a></li><li data-type='method' style='display: none;'><a href="module-context_canvas-Canvas.html#refresh">refresh</a></li><li data-type='method' style='display: none;'><a href="module-context_canvas-Canvas.html#point">point</a></li><li data-type='method' style='display: none;'><a href="module-context_canvas-Canvas.html#line">line</a></li><li data-type='method' style='display: none;'><a href="module-context_canvas-Canvas.html#lines">lines</a></li><li data-type='method' style='display: none;'><a href="module-context_canvas-Canvas.html#circle">circle</a></li><li data-type='method' style='display: none;'><a href="module-context_canvas-Canvas.html#rect">rect</a></li></ul></li><li><a href="module-particle_area-BaseArea.html">BaseArea</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_area-BaseArea.html#in">in</a></li></ul></li><li><a href="module-particle_area-Area.html">Area</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_area-Area.html#in">in</a></li></ul></li><li><a href="module-particle_area-RectArea.html">RectArea</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_area-RectArea.html#in">in</a></li></ul></li><li><a href="module-particle_area-CircleArea.html">CircleArea</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_area-CircleArea.html#in">in</a></li></ul></li><li><a href="module-particle_border-Border.html">Border</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_border-Border.html#limit">limit</a></li></ul></li><li><a href="module-particle_border-RectReflectBorder.html">RectReflectBorder</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_border-RectReflectBorder.html#limit">limit</a></li></ul></li><li><a href="module-particle_border-RectLoopBorder.html">RectLoopBorder</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_border-RectLoopBorder.html#limit">limit</a></li></ul></li><li><a href="module-particle_border-RingReflectBorder.html">RingReflectBorder</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_border-RingReflectBorder.html#limit">limit</a></li></ul></li><li><a href="module-particle_border-RingLoopBorder.html">RingLoopBorder</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_border-RingLoopBorder.html#limit">limit</a></li></ul></li><li><a href="module-particle_coor-CoordinateSystem.html">CoordinateSystem</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_coor-CoordinateSystem.html#to">to</a></li><li data-type='method' style='display: none;'><a href="module-particle_coor-CoordinateSystem.html#from">from</a></li></ul></li><li><a href="module-particle_coor-RCS.html">RCS</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_coor-RCS.html#to">to</a></li><li data-type='method' style='display: none;'><a href="module-particle_coor-RCS.html#from">from</a></li><li data-type='method' style='display: none;'><a href="module-particle_coor-RCS.html#zoom">zoom</a></li><li data-type='method' style='display: none;'><a href="module-particle_coor-RCS.html#move">move</a></li></ul></li><li><a href="module-particle_coor-Grid.html">Grid</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_coor-Grid.html#to">to</a></li><li data-type='method' style='display: none;'><a href="module-particle_coor-Grid.html#from">from</a></li></ul></li><li><a href="module-particle_coor-PolarCS.html">PolarCS</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_coor-PolarCS.html#to">to</a></li><li data-type='method' style='display: none;'><a href="module-particle_coor-PolarCS.html#from">from</a></li></ul></li><li><a href="module-particle_field-Field.html">Field</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_field-Field.html#force">force</a></li></ul></li><li><a href="module-particle_field-Gravity.html">Gravity</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_field-Gravity.html#force">force</a></li><li data-type='method' style='display: none;'><a href="module-particle_field-Gravity.html#.gravity">gravity</a></li></ul></li><li><a href="module-particle_field-AccelerateField.html">AccelerateField</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_field-AccelerateField.html#force">force</a></li></ul></li><li><a href="module-particle_field-DecelerateField.html">DecelerateField</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_field-DecelerateField.html#force">force</a></li></ul></li><li><a href="module-particle_field-DeflectField.html">DeflectField</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_field-DeflectField.html#force">force</a></li></ul></li><li><a href="module-particle_particle-Particle.html">Particle</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_particle-Particle.html#action">action</a></li><li data-type='method' style='display: none;'><a href="module-particle_particle-Particle.html#isEnd">isEnd</a></li></ul></li><li><a href="module-particle_particle-ForceParticle.html">ForceParticle</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_particle-ForceParticle.html#force">force</a></li><li data-type='method' style='display: none;'><a href="module-particle_particle-ForceParticle.html#action">action</a></li></ul></li><li><a href="module-particle_particle-LinearMotorParticle.html">LinearMotorParticle</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_particle-LinearMotorParticle.html#isEnd">isEnd</a></li><li data-type='method' style='display: none;'><a href="module-particle_particle-LinearMotorParticle.html#action">action</a></li></ul></li><li><a href="module-particle_particle-CircularMotorParticle.html">CircularMotorParticle</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_particle-CircularMotorParticle.html#action">action</a></li></ul></li><li><a href="module-particle_particle-RandomWalkerParticle.html">RandomWalkerParticle</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_particle-RandomWalkerParticle.html#_probability">_probability</a></li><li data-type='method' style='display: none;'><a href="module-particle_particle-RandomWalkerParticle.html#rv_select">rv_select</a></li><li data-type='method' style='display: none;'><a href="module-particle_particle-RandomWalkerParticle.html#action">action</a></li></ul></li><li><a href="module-particle_particle_system-ParticleSystem.html">ParticleSystem</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-particle_particle_system-ParticleSystem.html#build">build</a></li><li data-type='method' style='display: none;'><a href="module-particle_particle_system-ParticleSystem.html#particle_action">particle_action</a></li><li data-type='method' style='display: none;'><a href="module-particle_particle_system-ParticleSystem.html#action">action</a></li></ul></li><li><a href="module-particle_tracker-TrailTracker.html">TrailTracker</a></li><li><a href="module-utils_iterator-Iterator.html">Iterator</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-utils_iterator-Iterator.html#val">val</a></li><li data-type='method' style='display: none;'><a href="module-utils_iterator-Iterator.html#end">end</a></li><li data-type='method' style='display: none;'><a href="module-utils_iterator-Iterator.html#tolist">tolist</a></li></ul></li><li><a href="module-utils_iterator-Range.html">Range</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-utils_iterator-Range.html#.S">S</a></li><li data-type='method' style='display: none;'><a href="module-utils_iterator-Range.html#.N">N</a></li><li data-type='method' style='display: none;'><a href="module-utils_iterator-Range.html#val">val</a></li><li data-type='method' style='display: none;'><a href="module-utils_iterator-Range.html#end">end</a></li><li data-type='method' style='display: none;'><a href="module-utils_iterator-Range.html#clone">clone</a></li></ul></li><li><a href="module-utils_iterator-FuncIterator.html">FuncIterator</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-utils_iterator-FuncIterator.html#val">val</a></li><li data-type='method' style='display: none;'><a href="module-utils_iterator-FuncIterator.html#end">end</a></li></ul></li><li><a href="module-utils_random-RandomSelector.html">RandomSelector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-utils_random-RandomSelector.html#_probability">_probability</a></li><li data-type='method' style='display: none;'><a href="module-utils_random-RandomSelector.html#select">select</a></li></ul></li><li><a href="module-utils_tools-Tools.html">Tools</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-utils_tools-Tools.html#.regular_polygon">regular_polygon</a></li><li data-type='method' style='display: none;'><a href="module-utils_tools-Tools.html#.ATR">ATR</a></li><li data-type='method' style='display: none;'><a href="module-utils_tools-Tools.html#.RTA">RTA</a></li><li data-type='method' style='display: none;'><a href="module-utils_tools-Tools.html#.random">random</a></li><li data-type='method' style='display: none;'><a href="module-utils_tools-Tools.html#.rselect">rselect</a></li><li data-type='method' style='display: none;'><a href="module-utils_tools-Tools.html#.RGB">RGB</a></li></ul></li><li><a href="module-vector_vector-Vector.html">Vector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#.v">v</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#.ones">ones</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#.zeros">zeros</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#.random">random</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#.rcv">rcv</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#add">add</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#mult">mult</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#sub">sub</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#dot">dot</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#inner">inner</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#.LC">LC</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#LM">LM</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#lerp">lerp</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#rotate">rotate</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#dim">dim</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#norm">norm</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#normalization">normalization</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#limit">limit</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#clone">clone</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#copy">copy</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#dist">dist</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#rad">rad</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#toint">toint</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#in">in</a></li><li data-type='method' style='display: none;'><a href="module-vector_vector-Vector.html#.vpoints">vpoints</a></li></ul></li><li><a href="module-views_capturer-Capturer.html">Capturer</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-views_capturer-Capturer.html#capturing">capturing</a></li><li data-type='method' style='display: none;'><a href="module-views_capturer-Capturer.html#capture">capture</a></li></ul></li><li><a href="module-views_color-ColorVector.html">ColorVector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-views_color-ColorVector.html#color">color</a></li><li data-type='method' style='display: none;'><a href="module-views_color-ColorVector.html#val">val</a></li><li data-type='method' style='display: none;'><a href="module-views_color-ColorVector.html#clone">clone</a></li></ul></li><li><a href="module-views_color-ColorGradient.html">ColorGradient</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-views_color-ColorGradient.html#color">color</a></li><li data-type='method' style='display: none;'><a href="module-views_color-ColorGradient.html#isEnd">isEnd</a></li></ul></li><li><a href="module-views_randerer-Randerer.html">Randerer</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-views_randerer-Randerer.html#rander">rander</a></li></ul></li><li><a href="module-views_randerer-IntervalRanderer.html">IntervalRanderer</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-views_randerer-IntervalRanderer.html#rander">rander</a></li><li data-type='method' style='display: none;'><a href="module-views_randerer-IntervalRanderer.html#stop">stop</a></li></ul></li><li><a href="module-views_randerer-SingleFrameRanderer.html">SingleFrameRanderer</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-views_randerer-SingleFrameRanderer.html#rander">rander</a></li></ul></li><li><a href="module-views_views-Views.html">Views</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-views_views-Views.html#.nodelink">nodelink</a></li><li data-type='method' style='display: none;'><a href="module-views_views-Views.html#.grid">grid</a></li><li data-type='method' style='display: none;'><a href="module-views_views-Views.html#.lightLine">lightLine</a></li><li data-type='method' style='display: none;'><a href="module-views_views-Views.html#.lightRing">lightRing</a></li><li data-type='method' style='display: none;'><a href="module-views_views-Views.html#.trail">trail</a></li></ul></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">particle/particle.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module
 * @desc     粒子类: 基于向量模拟抽象粒子的运动
 * @project  Vision
 * @author   Ais
 * @date     2022-07-10
 * @version  0.1.0
*/


import { Vector } from "../vector/vector.js";


//粒子(基类)
class Particle {

    /**
     * @classdesc 粒子基类: 基于向量模拟抽象粒子的运动
     * 
     * @property { Vector } p - 位置向量
     * @property { Vector } v - 速度向量
     * 
     * @param { Vector } [position=vector(0, 0)] - 初始位置向量
     * @param { Vector } [velocity=vector(0, 0)] - 初始速度向量
     * 
     * @example
     * let p = new Particle(new Vector(100, 100), new Vector(2, 3));
     */
    constructor(position, velocity) {
        this.p = position || new Vector(0, 0);
        this.v = velocity || new Vector(0, 0);
    }

    /**
     * 运动模式: 描述粒子的运动模式
     * 
     * @returns { Vector } 粒子的位置向量(this.p)
     */
    action() {
        return this.p.add(this.v);
    }

    /**
     * 停机状态: 描述粒子的停机状态
     * 
     * @returns { boolean } 停机状态
     */
    isEnd() {
        return false;
    }
}


//作用力粒子
class ForceParticle extends Particle {

    /**
     * @classdesc 作用力粒子: 可进行受力和进行相互作用
     * 
     * @property { Vector } p - 位置向量
     * @property { Vector } v - 速度向量
     * @property { Vector } acc - 加速度
     * @property { number } mass - 质量
     * 
     * @param { Vector } [position=vector(0, 0)] - 初始位置向量
     * @param { Vector } [velocity=vector(0, 0)] - 初始速度向量
     * @param { Vector } [acceleration=vector(0, 0)] - 初始加速度 
     * @param { number } [mass=1] - 质量
     *  
     */
    constructor(position, velocity, acceleration, mass) {
        super();
        this.p = position || new Vector(0, 0);
        this.v = velocity || new Vector(0, 0);
        this.acc = acceleration || new Vector(0, 0);
        this.mass = mass || 1;
    }

    /**
     * 受力作用: 通过受力来改变粒子的加速度(积累效应)
     * 
     * @param { Vector } f - 作用力 
     */
    force(f) {
        this.acc.add(f.clone().mult(1/this.mass));
    }

    /** @override */
    action() {
        this.p.add(this.v.add(this.acc));
        this.acc = new Vector(0, 0);
        return this.p;
    }
}


//线性运动粒子
class LinearMotorParticle extends Particle {

    /**
     * @classdesc 线性运动: 描述直线运动模式的粒子
     * 
     * @property { Vector } p - 位置向量
     * @property { Vector } v - 速度向量
     * @property { Vector } ps - 初始位置向量
     * @property { Vector } pe - 终止位置向量
     * @property { Enum } [mode="line"] - 运动模式   
     * {"line": 移动到pe后停机, "loop": 移动到pe后回到ps, "back":移动到pe后，ps与pe互换}
     * @property { number } [end_dist_rate=1.2] - 终止距离误差倍率  
     * 用于终点距离的判断: end_dist &lt;= this.v.norm() * this.end_dist_rate  
     * 
     * @param { Vector } ps - 初始位置向量
     * @param { Vector } pe - 终止位置向量
     * @param { number } [v_rate=1] - 设置粒子运动速率
     * 
     * @example 
     * let lmp = new vision.particle.LinearMotorParticle(
     *     new Vector(200, 200), 
     *     new Vector(1000, 200),
     *     v_rate = 5
     * );
     */
    constructor(ps, pe, v_rate=1) {
        super();
        this._ps = ps;
        this._pe = pe;
        this.p = this._ps.clone();
        this.v = Vector.sub(this._pe, this._ps).norm(Math.abs(v_rate));
        this.mode = "line";
        this.end_dist_rate = 1.2;
    }
    
    get ps() { return this._ps.clone(); }
    get pe() { return this._pe.clone(); }
    
    //设置终止位置(并重新计算速度方向)
    set pe(vector) {
        this._pe = vector.clone();
        this.v = Vector.sub(this._pe, this.p).norm(this.v.norm());
    }

    /** 
     * 设置速率: 速度矢量的模长, 每次迭代移动的像素大小
     * 
     * @param { number } val - 速率(val>0)
     * @example p.v_rate = 5;
     */
    set v_rate(val) { this.v.norm(val); }
    /**
     * 设置速率: 经过多少次迭代后移动到 **pe**
     * 
     * @param { number } val - 速率(val>0)
     * @example p.v_count = 300;
     */
    set v_count(val) { this.v.norm(Vector.dist(this._pe, this._ps) / val); }

    /** @override */
    isEnd() {
        return this.p.dist(this._pe) &lt;= this.v.norm() * this.end_dist_rate;
    }

    /** @override */
    action() {
        if(!this.isEnd()) {
            this.p.add(this.v);
        } else {
            switch(this.mode){
                case "loop": {
                    this.p = this._ps.clone();
                    break;
                }
                case "back": {
                    this.p = this._pe.clone();
                    this._pe = this._ps.clone();
                    this._ps = this.p.clone();
                    this.v.mult(-1);
                    break;
                }
                default: {
                    this.p = this._pe.clone();
                }
            }
        }
        return this.p;
    }
}


//环形运动系统
class CircularMotorParticle extends Particle {

    /**
     * 环形运动: 描述环形运动模式的粒子
     * 
     * @property { Vector } o - 圆心位置
     * @property { number } r - 旋转半径
     * @property { number } w - 角速度 
     * @property { number } rad - 当前弧度
     * @property { Vector } po - 当前坐标(以this.o为原点)
     * @property { Vector } p - 当前坐标(以(0, 0)为原点)
     * 
     * @param { Vector } [o=vector(0, 0)] - 圆心位置
     * @param { number } [r=1] - 旋转半径
     * @param { number } [w=(Math.PI/180)] - 角速度 
     * @param { number } [rad=0] - 初始弧度位置
     * 
     * @example 
     * let cmp = new CircularMotorParticle(new Vector(1400, 300), 100, Math.PI/180);
     */
    constructor(o, r=1, w=(Math.PI/180), rad=0) {
        super();
        this.o = o || new Vector(0, 0);
        this.r = r;
        this.w = w;
        this.rad = rad;
        this.po = new Vector(this.r*Math.sin(this.rad), this.r*Math.cos(this.rad));
        this.p = Vector.add(this.po, this.o);
    }

    /** @override */
    action() {
        this._p = this.p.clone();
        this.rad += this.w;
        if(this.rad >= 2 * Math.PI) { this.rad -= 2 * Math.PI; } 
        if(this.rad &lt;= -2 * Math.PI) { this.rad += 2 * Math.PI; } 
        this.po.x = this.r * Math.sin(this.rad);
        this.po.y = this.r * Math.cos(this.rad);
        this.p = Vector.add(this.po, this.o);
        this.v = this.p.clone().sub(this._p);
        return this.p;
    }

}


//随机游走器
class RandomWalkerParticle extends Particle {
    
    /*----------------------------------------
    @func: 随机游走
    @desc: 给定一组速度向量集，每次随机选择一个速度进行移动
    @property: 
        * ps(Vector): 初始位置
        * rvs(list): 随机速度向量集 -> [Vector(速度向量), wt(权重)]
    ----------------------------------------*/
    /**
     * 随机游走模式: 给定一组速度向量集，每次随机选择一个速度进行移动
     * 
     * @property { Vector } p - 位置向量
     * @property { Object[] } _rvs - 随机速度向量集
     * @property { Vector } _rvs.v - 速度向量
     * @property { number } _rvs.p - 选择概率
     * @property { number } _rvs.ps - 起始概率值
     * @property { number } _rvs.pe - 终止概率值
     * 
     * @param { Vector } ps -  初始位置向量
     * @param { Array[] } rvs - 随机速度向量集: [[Vector(速度向量), wt(权重)], ...]
     * 
     * @example
     * let vd = 3;
     * let rw = new RandomWalkerParticle(new Vector(canvas.cx, canvas.cy), [
     *     [new Vector(-1, -1).mult(vd), 1/8],
     *     [new Vector(0, -1).mult(vd), 1/8],
     *     [new Vector(1, -1).mult(vd), 1/8],
     *     [new Vector(-1, 0).mult(vd), 1/8],
     *     [new Vector(1, 0).mult(vd), 1/8],
     *     [new Vector(-1, 1).mult(vd), 1/8],
     *     [new Vector(0, 1).mult(vd), 1/8],
     *     [new Vector(1, 1).mult(vd), 1/8],
     * ]);
     */
    constructor(ps, rvs) {
        super();
        this.p = ps;
        this._rvs = this._probability(rvs);
    }

    /**
     * 计算概率(基于权重): p[i] = wt[i] / sum(wt)
     * 
     * @param { Array[] } rvs - 随机速度向量集: [[Vector(速度向量), wt(权重)], ...]
     * @returns { Object } 随机速度向量集: [{"v": "速度", "p": "概率", "ps/pe": "概率范围"}, ...]
     */
    _probability(rvs) {
        //计算总权重
        let swt = 0;
        for(let i=0, end=rvs.length; i&lt;end; i++) {
            swt += rvs[i][1];
        }
        //计算每个速度矢量的概率
        let _rvs = [], _ps = 0;
        for(let i=0, end=rvs.length; i&lt;end; i++) {
            let p = (rvs[i][1] || 0) / swt;
            _rvs.push({
                //速度
                "v": rvs[i][0] || new Vector(0, 0),
                //概率
                "p": p,
                //概率范围
                "ps": _ps, "pe": _ps + p
            });
            _ps += p;
        }
        return _rvs;
    }

    /**
     * 从 *随机速度向量集* 中随机选择一个速度向量
     * 
     * @returns { Object } {"v": "速度", "p": "概率", "ps/pe": "概率范围"}
     */
    rv_select() {
        let r = Math.random();
        for(let i=0, end=this._rvs.length; i&lt;end; i++) {
            if(r > this._rvs[i].ps &amp;&amp; r &lt;= this._rvs[i].pe) {
                return this._rvs[i].v;
            }
        }
    }

    /** @override */
    action() {
        //选择随机速度
        this.v = this.rv_select();
        return this.p.add(this.v);
    }
}


export { Particle, ForceParticle, LinearMotorParticle, CircularMotorParticle, RandomWalkerParticle };</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.2</a> on Fri Apr 28 2023 00:11:47 GMT+0800 (香港标准时间) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
