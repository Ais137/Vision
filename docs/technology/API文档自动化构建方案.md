# API文档自动化构建方案

Meta:
* Date : 2023-04-27
* Author : Ais
* Desc : API文档自动化构建方案评估

--------------------------------------------------
## 问题场景
一个完整的项目，不单是要求在架构设计上的合理性，其附带的工程化规范流程也同样重要。
随着Vision项目的持续推进，项目代码量持续增加，当偶尔引用一些不常用的模块时，
在缺乏API文档的情况下，需要到源码中搜索并查看注释以了解模块的使用方式，这种方式不管是对于框架开发者
还是使用者都是繁琐且不合理的，因此迫切的需要在项目中引入一种 *API文档自动化构建方案*，从源码中提取注释并自动构建API文档。
以提高开发效率和框架的易用性。

--------------------------------------------------
## 需求分析
对于 *API文档自动化构建方案* 的需求如下
1. **核心需求** : 扫描指定目录从源码中提取注释并自动构建API文档
2. 注释的规范化标准
3. 注释字段支持自定义格式
4. 注释字段支持markdown语法
5. 支持通过插件进行扩展和自定义

--------------------------------------------------
## 技术简介
通过对现有的解决方案进行考察，主要有以下几种:
### 1. JSDoc
> JSDoc 3 是一个用于 JavaScript 的API文档生成器，类似于 Javadoc 或 phpDocumentor。可以将文档注释直接添加到源代码中。JSDoc 工具将扫描您的源代码并为您生成一个 HTML 文档网站。  

> JSDoc 的目的是记录 JavaScript 应用程序或库的 API。假设您想要记录诸如模块、名称空间、类、方法、方法参数等内容。  

> JSDoc注释通常应该放在记录代码之前。为了被 JSDoc 解析器识别，每个注释必须以 /** 序列开头。以 /*、/***开头或超过3颗星的注释将被忽略。这个特性用于控制解析注释块的功能。

最简单的文档示例就是描述：
```js
/** This is a description of the foo function. */
function foo() {

}
```
### 2. ESDoc
> 一个 JavaScript 文档生成器，按照规范编写代码注释，即可生成友好的 JavaScript 代码文档。它可以将测试代码和用户手册一并集成到文档中，支持通过插件添加自定义功能。
* 生成良好的文档。
* 测量文档覆盖率。
* 将测试代码集成到文档中。
* 将手册集成到文档中。
### 3. APIDoc
> RESTful Web API 文档生成器，支持多种语言，以代码注释的形式生成API文档

--------------------------------------------------
## 方案评估
在上述方案中首先排除 *APIDoc* ，这是由于其主要设计是偏向于web接口文档类型，与现有项目的需求不是很匹配。
因此在剩下的 *JSDoc* 与 *ESDoc* 两种方案之间选择。对于这两种方案都可以满足 *需求分析* 中的需求。而对于
*ESDoc* 来说，其支持的额外功能更多，比如可以检测文档覆盖率，集成测试代码等。但是上述功能对于现有项目并不需要。
同时考虑到两个项目的社区活跃度和更新维护频率，*JSDoc* 相对于 *ESDoc* 优势更大。因此在满足现有需求的条件下
优先考虑活跃度更高的 *JSDoc* 解决方案。

--------------------------------------------------
## 可行性评估
由于在项目的初步开发阶段，就制定了完整的注释规范，因此只需要将现有注释迁移到 *JSDoc* 的注释规范，并添加
*JSDoc* 的构建依赖和配置文件即可。

--------------------------------------------------
## 实施方案
具体的迁移实施方案如下:
1. 将现有注释迁移到 *JSDoc* 注释规范。
2. 添加 *JSDoc* 的构建依赖并编写配置文件
3. 添加 *docdash* 主题，并进行部分风格样式的定制。
4. 迁移到 github pages 

--------------------------------------------------
## 参考
* [给 Web 开发人员推荐的文档生成工具](https://juejin.cn/post/6844903497222062087)
* [jsdoc中文文档](https://www.jsdoc.com.cn/)
* [jsdoc-github](https://github.com/jsdoc/jsdoc)
* [esdoc-github](https://github.com/esdoc/esdoc)